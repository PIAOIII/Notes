[TOC]

# Session
## 1 启用Session
Django项目默认启用Session。
可以在settings.py文件中查看，如图所示
![图 1](../static/3.7.2_Session-Django中间件.png)  
如需禁用session，将上图中的session中间件注释掉即可。

## 2 存储方式
在settings.py文件中，可以设置session数据的存储方式(位置：随便挑一行写就行)，可以保存在数据库、本地缓存等。

### 2.1 数据库
存储在数据库中，如下设置可以写，也可以不写，这是默认存储方式。
```py
SESSION_ENGINE='django.contrib.sessions.backends.db'
```

如果存储在数据库中，需要在项INSTALLED_APPS中安装Session应用。
![图 2](../static/3.7.2_Session-在项INSTALLED_APPS中安装Session应用.png)  
数据库中的session表如图所示
![图 3](../static/3.7.2_Session-数据库中的session表.png)  
session表结构如下
![图 4](../static/3.7.2_Session-session表结构.png)  
由表结构可知，操作Session包括三个数据：键，值，过期时间。















(py3_django) sun@ubuntu20:~/Desktop/my_projects/Django_basic/bookmanager3$ pip list
Package     Version
----------- -------
Django      2.2.5
mysqlclient 2.1.1
pip         22.2.2
pytz        2022.1
setuptools  63.2.0
sqlparse    0.4.2
wheel       0.37.1
(py3_django) sun@ubuntu20:~/Desktop/my_projects/Django_basic/bookmanager3$ pip install django-redis
Collecting django-redis
  Downloading django_redis-5.2.0-py3-none-any.whl (30 kB)
Requirement already satisfied: Django>=2.2 in /home/sun/.virtualenvs/py3_django/lib/python3.10/site-packages (from django-redis) (2.2.5)
Collecting redis!=4.0.0,!=4.0.1,>=3
  Downloading redis-4.3.4-py3-none-any.whl (246 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 246.2/246.2 kB 18.3 kB/s eta 0:00:00
Requirement already satisfied: pytz in /home/sun/.virtualenvs/py3_django/lib/python3.10/site-packages (from Django>=2.2->django-redis) (2022.1)
Requirement already satisfied: sqlparse in /home/sun/.virtualenvs/py3_django/lib/python3.10/site-packages (from Django>=2.2->django-redis) (0.4.2)
Collecting packaging>=20.4
  Downloading packaging-21.3-py3-none-any.whl (40 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40.8/40.8 kB 14.8 kB/s eta 0:00:00
Collecting deprecated>=1.2.3
  Downloading Deprecated-1.2.13-py2.py3-none-any.whl (9.6 kB)
Collecting async-timeout>=4.0.2
  Downloading async_timeout-4.0.2-py3-none-any.whl (5.8 kB)
Collecting wrapt<2,>=1.10
  Downloading wrapt-1.14.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (77 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 77.9/77.9 kB 13.2 kB/s eta 0:00:00
Collecting pyparsing!=3.0.5,>=2.0.2
  Downloading pyparsing-3.0.9-py3-none-any.whl (98 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 98.3/98.3 kB 11.5 kB/s eta 0:00:00
Installing collected packages: wrapt, pyparsing, async-timeout, packaging, deprecated, redis, django-redis
Successfully installed async-timeout-4.0.2 deprecated-1.2.13 django-redis-5.2.0 packaging-21.3 pyparsing-3.0.9 redis-4.3.4 wrapt-1.14.1
(py3_django) sun@ubuntu20:~/Desktop/my_projects/Django_basic/bookmanager3$ pip list
Package       Version
------------- -------
async-timeout 4.0.2
Deprecated    1.2.13
Django        2.2.5
django-redis  5.2.0
mysqlclient   2.1.1
packaging     21.3
pip           22.2.2
pyparsing     3.0.9
pytz          2022.1
redis         4.3.4
setuptools    63.2.0
sqlparse      0.4.2
wheel         0.37.1
wrapt         1.14.1






