[TOC]

```sql
CREATE TABLE "SYSDBA"."test_sxy"
(
"id" BIGINT IDENTITY(1, 1) NOT NULL,
"name" CHAR(10) NOT NULL,
"gender" INT DEFAULT 0 NOT NULL,
UNIQUE("id"),
UNIQUE("name"),
UNIQUE("gender"),
NOT CLUSTER PRIMARY KEY("id")) STORAGE(ON "MAIN", CLUSTERBTR) ;

COMMENT ON TABLE "SYSDBA"."test_sxy" IS '测试';
COMMENT ON COLUMN "SYSDBA"."test_sxy"."id" IS 'id';
COMMENT ON COLUMN "SYSDBA"."test_sxy"."name" IS 'name';
COMMENT ON COLUMN "SYSDBA"."test_sxy"."gender" IS 'gender';
```

```sql
CREATE TABLE `std_data_lxcs.cswg_std_wgtjxx`(
`sqdm` string COMMENT '社区代码',  
`syrkzs` string COMMENT '实有人口总数',  
`hjrks` string COMMENT '户籍人口数',  
`ldrks` string COMMENT '流动人口数',  
`ckrs` string COMMENT '常口人数',  
`zkrs` string COMMENT '暂口人数',  
`jwrys` string COMMENT '境外人员数',  
`wzrys` string COMMENT '无证人员数',  
`hsjcrks` string COMMENT '核酸检测人口数',  
`zhtjsj` string COMMENT '最后统计时间',  
`cjsj` string COMMENT '创建时间',  
`tjlx` string COMMENT '统计类型')
COMMENT '网格统计信息'
PARTITIONED BY (
`fq_sjzq` string COMMENT'分区字段')
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/std_data_lxcs.db/cswg_std_wgtjxx';
```

# test_sun
```sql
CREATE TABLE `ods_data_lxcs.test_sun`(
`xmdm`	string COMMENT	'项目代码',
`xmmc`  string COMMENT  '项目名称',
`xmcyrs`	int COMMENT	'项目参与人数',		
`xmys`	string COMMENT	'项目预算',		
`xmkssj`	string COMMENT	'项目开始时间',		
`xmwcsj`	string COMMENT	'项目完成时间')
COMMENT '测试_孙'
PARTITIONED BY (
`fq_sjzq` string COMMENT'分区字段')
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (  -- 序列化/反序列化参数
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/ods_data_lxcs.db/test_sun';
```

```sql
truncate table dwd_data_lxcs.mxtj_dwd_cssjtjf;
with a as(
select 'cssj_dwd_xfb_county_pv7' as table_name, fq_sjzq as update_time, count(*) as sl from dwd_data_lxcs.cssj_dwd_xfb_county_pv7 group by fq_sjzq
union all
select 'cssj_dwd_xfb_county_pv_sy' as table_name,fq_sjzq as update_time,count(*) as sl from dwd_data_lxcs.cssj_dwd_xfb_county_pv_sy group by fq_sjzq
),
b as (select table_name,update_time,sl, row_number()over(partition by table_name order by update_time desc) as r from a),
c as (select table_name,update_time,sl from b where r <=1)
insert overwrite table dwd_data_lxcs.mxtj_dwd_cssjtjf
select count(1) as bsl,sum (sl) as sjl from c
```

```sql
CREATE TABLE `ods_data.ods_zlsgs_sflsls`(
`sflsh` string COMMENT '收费流水号',
`sfsj` string COMMENT '收费时间',
`yhbh` string COMMENT '用户编号',
`sfn` string COMMENT '水费年',
`sfy` string COMMENT '水费月',
`fy` string COMMENT '费用',
`sfxz` string COMMENT '收费性质',
`sfr` string COMMENT '收费人',
`sfdw` string COMMENT '收费单位',
`qcjy` string COMMENT '期初结余',
`qwjy` string COMMENT '期未结余',
`dycs` string COMMENT '打印次数',
`bc` string COMMENT '被冲',
`bch` string COMMENT '被冲号',
`czr` string COMMENT '操作人',
`czsj` string COMMENT '操作时间',
`bz` string COMMENT '备注',
`sfmc` string COMMENT '收费名称',
`fph` string COMMENT '发票号',
`dz` string COMMENT '对账',
`xzdycs` string COMMENT '限制打印次数',
`fc` string COMMENT '费次',
`sffs` string COMMENT '实付方式',
`czyy` string COMMENT '冲账原因',
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '收费流水历史'
PARTITIONED BY (
`fq_sjzq` string)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/ods_data.db/ods_zlsgs_sflsls'
TBLPROPERTIES (
'bucketing_version'='2',
'transient_lastDdlTime'='1663641203') 
```

```sql
-- show create table dwd_data_lxcs.mxtj_dwd_cssjtjf

-- select * from dwd_data_lxcs.mxtj_dwd_cssjtjf

select * from ods_data_lxcs.test_sun2

-- truncate table ods_data_lxcs.test_sun2;

-- insert overwrite table ods_data_lxcs.test_sun2
-- select sflsh,sfsj,yhbh,sfn,sfy,fy,sfxz,fq_sjzq from ods_data.ods_zlsgs_sflsls
```