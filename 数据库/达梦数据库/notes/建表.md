[TOC]

模板

- [ ] 内部表，不能用EXTERNAL
- [ ] **改模式名，表名**
- [ ] **改LOCATION**， **模式名后加`.db`**

规整
```sql
alter table table_name drop if exists partition(fq_sjzq = '');

insert overwrite table table_name partition (fq_sjzq = '')
select 
from table_name
where fq_sjzq in (select max(fq_sjzq) from table_name)
group by 
```

CREATE EXTERNAL TABLE `ods_data.ods_gaj_czrkjbxx`
```sql
CREATE EXTERNAL TABLE `ods_data.ods_gaj_czrkjbxx`(
`rynbid` string COMMENT '人员内部ID',
`ryid` string COMMENT '人员ID',
`hhnbid` string COMMENT '户号内部ID',
`mlpnbid` string COMMENT '门楼牌内部ID',
`zpid` string COMMENT '照片ID',
`nbsfzid` string COMMENT '内部身份证ID',
`gmsfhm` string COMMENT '公民身份证号',
`qfjg` string COMMENT '签发机关',
`yxqxqsrq` string COMMENT '有效期限起始日期',
`yxqxjzrq` string COMMENT '有效期限结束日期',
`xm` string COMMENT '姓名',
`cym` string COMMENT '曾用名',
`xmpy` string COMMENT '姓名拼音',
`cympy` string COMMENT '曾用名拼音',
`xb` string COMMENT '性别',
`mz` string COMMENT '民族',
`csrq` string COMMENT '出生日期',
`cssj` string COMMENT '出生时间',
`csdgjdq` string COMMENT '出生地国家地区',
`csdssxq` string COMMENT '出生地省市县区',
`csdxz` string COMMENT '出生地详址',
`dhhm` string COMMENT '电话号码',
`jhryxm` string COMMENT '监护人一姓名',
`jhrygmsfhm` string COMMENT '监护人一身份证号',
`jhryjhgx` string COMMENT '监护人一关系',
`jhrexm` string COMMENT '监护人二姓名',
`jhregmsfhm` string COMMENT '监护人二身份证号',
`jhrejhgx` string COMMENT '监护人二关系',
`fqxm` string COMMENT '父亲姓名',
`fqgmsfhm` string COMMENT '父亲身份证号',
`mqxm` string COMMENT '母亲姓名',
`mqgmsfhm` string COMMENT '母亲身份证号',
`poxm` string COMMENT '配偶姓名',
`pogmsfhm` string COMMENT '配偶身份证号',
`jggjdq` string COMMENT '籍贯国家地区',
`jgssxq` string COMMENT '籍贯省市县区',
`zjxy` string COMMENT '宗教信仰',
`whcd` string COMMENT '文化程度',
`hyzk` string COMMENT '婚姻状况',
`byzk` string COMMENT '兵役状况',
`sg` string COMMENT '身高',
`xx` string COMMENT '血型',
`zy` string COMMENT '职业',
`zylb` string COMMENT '职业类别',
`fwcs` string COMMENT '服务处所',
`xxjb` string COMMENT '信息级别',
`hsql` string COMMENT '何时迁来',
`hyql` string COMMENT '何因迁来',
`hgjdqql` string COMMENT '何国家地区迁来',
`hssxqql` string COMMENT '何省市县区迁来',
`hxzql` string COMMENT '何详址迁来',
`hslbz` string COMMENT '何时来本址',
`hylbz` string COMMENT '何因来本址',
`hgjdqlbz` string COMMENT '何国家地区来本址',
`hsssqlbz` string COMMENT '何省市县区来本址',
`hxzlbz` string COMMENT '何详址来本址',
`swrq` string COMMENT '死亡时间',
`swzxlb` string COMMENT '死亡注销类别',
`swzxrq` string COMMENT '死亡注销日期',
`qcrq` string COMMENT '迁出日期',
`qczxlb` string COMMENT '迁出注销类别',
`qwdgjdq` string COMMENT '迁往地国家地区',
`qwdssxq` string COMMENT '迁往地省市县区',
`qwdxz` string COMMENT '迁往地详址',
`cszmbh` string COMMENT '出生证明编号',
`cszqfrq` string COMMENT '出生证签发日期',
`hylb` string COMMENT '行业类别',
`qtssxq` string COMMENT '其它省市县区',
`qtzz` string COMMENT '其它住址',
`rylb` string COMMENT '人员类别',
`hb` string COMMENT '户别',
`yhzgx` string COMMENT '与户主关系',
`ryzt` string COMMENT '人员状态',
`rysdzt` string COMMENT '人员锁定状态',
`lxdbid` string COMMENT '离线DBID',
`bz` string COMMENT '备注',
`jlbz` string COMMENT '记录标志',
`ywnr` string COMMENT '业务内容',
`cjhjywid` string COMMENT '创建户籍业务ID',
`cchjywid` string COMMENT '撤除户籍业务ID',
`qysj` string COMMENT '启用时间',
`jssj` string COMMENT '结束时间',
`cxbz` string COMMENT '撤销标志',
`zjlb` string COMMENT '证件类别',
`jlx` string COMMENT '街路巷',
`mlph` string COMMENT '门楼牌号',
`mlxz` string COMMENT '门楼详址',
`pcs` string COMMENT '派出所代码',
`zrq` string COMMENT '责任区',
`xzjd` string COMMENT '乡镇街道办',
`jcwh` string COMMENT '居委会',
`pxh` string COMMENT '排序号',
`mlpid` string COMMENT '门楼牌ID',
`ssxq` string COMMENT '行政区划',
`hh` string COMMENT '户号',
`hlx` string COMMENT '户类型',
`hhid` string COMMENT '户号ID',
`bdfw` string COMMENT '变动方式',
`xxqysj` string COMMENT '信息启用时间',
`dhhm2` string COMMENT '电话号码2',
`gxsj` string COMMENT '更新时间戳，格式yyyyMMddHH24mmss',
`zxsj` string COMMENT '死亡，注销的注销时间（合并SWRQ、QCRQ）',
`crynbid` string COMMENT '人员内部ID2',
`gxsjd` string COMMENT '更新时间戳',
`xmx` string COMMENT '姓',
`xmm` string COMMENT '名',
`jgxz` string COMMENT '籍贯详细地址',
`jhryzjzl` string COMMENT '监护人一证件种类',
`jhryzjhm` string COMMENT '监护人一证件号码',
`jhrywwx` string COMMENT '监护人一外文姓',
`jhrywwm` string COMMENT '监护人一外文名',
`jhrylxdh` string COMMENT '监护人一联系电话',
`jhrezjzl` string COMMENT '监护人二证件种类',
`jhrezjhm` string COMMENT '监护人二证件号码',
`jhrewwx` string COMMENT '监护人二外文姓',
`jhrewwm` string COMMENT '监护人二外文名',
`jhrelxdh` string COMMENT '监护人二联系电话',
`fqzjzl` string COMMENT '父亲证件种类',
`fqzjhm` string COMMENT '父亲证件号码',
`fqwwx` string COMMENT '父亲外文姓',
`fqwwm` string COMMENT '父亲外文名',
`mqzjzl` string COMMENT '母亲证件种类',
`mqzjhm` string COMMENT '母亲证件号码',
`mqwwx` string COMMENT '母亲外文姓',
`mqwwm` string COMMENT '母亲外文名',
`pozjzl` string COMMENT '配偶证件种类',
`pozjhm` string COMMENT '配偶证件号码',
`powwx` string COMMENT '配偶外文姓',
`powwm` string COMMENT '配偶外文名',
`hjdzbm` string COMMENT '户籍地址编码',
`hjdrhyz` string COMMENT '户籍地人户一致标识',
`cydwbm` string COMMENT '从业单位编码',
`qyldyy` string COMMENT '迁移（流动）原因',
`fqzd` string COMMENT '分区字段',
`sjlysd` string COMMENT '数据来源属地',
`jlrksj` string COMMENT '记录入库时间',
`zhgxsj` string COMMENT '最后更新时间',
`jlscbz` string COMMENT '记录删除标记',
`cwdm` string COMMENT '错误代码',
`sfrysc` string COMMENT '是否入要素层',
`jlxmc` string COMMENT '街路巷名称',
`id` string COMMENT '主键ID',
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '常住(户籍)人口信息'
PARTITIONED BY (
`fq_sjzq` string)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/ods_data.db/ods_gaj_czrkjbxx'
TBLPROPERTIES (
'bucketing_version'='2',
'spark.sql.partitionProvider'='catalog',
'transient_lastDdlTime'='1648804522') 
```

```sql
CREATE TABLE "SYSDBA"."test_sxy"
(
"id" BIGINT IDENTITY(1, 1) NOT NULL,
"name" CHAR(10) NOT NULL,
"gender" INT DEFAULT 0 NOT NULL,
UNIQUE("id"),
UNIQUE("name"),
UNIQUE("gender"),
NOT CLUSTER PRIMARY KEY("id")) STORAGE(ON "MAIN", CLUSTERBTR) ;

COMMENT ON TABLE "SYSDBA"."test_sxy" IS '测试';
COMMENT ON COLUMN "SYSDBA"."test_sxy"."id" IS 'id';
COMMENT ON COLUMN "SYSDBA"."test_sxy"."name" IS 'name';
COMMENT ON COLUMN "SYSDBA"."test_sxy"."gender" IS 'gender';
```

```sql
CREATE TABLE `std_data_lxcs.cswg_std_wgtjxx`(
`sqdm` string COMMENT '社区代码',  
`syrkzs` string COMMENT '实有人口总数',  
`hjrks` string COMMENT '户籍人口数',  
`ldrks` string COMMENT '流动人口数',  
`ckrs` string COMMENT '常口人数',  
`zkrs` string COMMENT '暂口人数',  
`jwrys` string COMMENT '境外人员数',  
`wzrys` string COMMENT '无证人员数',  
`hsjcrks` string COMMENT '核酸检测人口数',  
`zhtjsj` string COMMENT '最后统计时间',  
`cjsj` string COMMENT '创建时间',  
`tjlx` string COMMENT '统计类型')
COMMENT '网格统计信息'
PARTITIONED BY (
`fq_sjzq` string COMMENT'分区字段')
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/std_data_lxcs.db/cswg_std_wgtjxx';
```

# test_sun
```sql
CREATE TABLE `ods_data_lxcs.test_sun`(
`xmdm`	string COMMENT	'项目代码',
`xmmc`  string COMMENT  '项目名称',
`xmcyrs`	int COMMENT	'项目参与人数',		
`xmys`	string COMMENT	'项目预算',		
`xmkssj`	string COMMENT	'项目开始时间',		
`xmwcsj`	string COMMENT	'项目完成时间')
COMMENT '测试_孙'
PARTITIONED BY (
`fq_sjzq` string COMMENT'分区字段')
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (  -- 序列化/反序列化参数
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/ods_data_lxcs.db/test_sun';
```

```sql
with a as(
select 'cssj_dwd_xfb_county_pv7' as table_name, fq_sjzq as update_time, count(*) as sl from dwd_data_lxcs.cssj_dwd_xfb_county_pv7 group by fq_sjzq
union all
select 'cssj_dwd_xfb_county_pv_sy' as table_name,fq_sjzq as update_time,count(*) as sl from dwd_data_lxcs.cssj_dwd_xfb_county_pv_sy group by fq_sjzq
),
b as (select table_name,update_time,sl, row_number()over(partition by table_name order by update_time desc) as r from a),
c as (select table_name,update_time,sl from b where r <=1)
insert overwrite table dwd_data_lxcs.mxtj_dwd_cssjtjf
select count(1) as bsl,sum (sl) as sjl from c
```

```sql
CREATE TABLE `ods_data.ods_zlsgs_sflsls`(
`sflsh` string COMMENT '收费流水号',
`sfsj` string COMMENT '收费时间',
`yhbh` string COMMENT '用户编号',
`sfn` string COMMENT '水费年',
`sfy` string COMMENT '水费月',
`fy` string COMMENT '费用',
`sfxz` string COMMENT '收费性质',
`sfr` string COMMENT '收费人',
`sfdw` string COMMENT '收费单位',
`qcjy` string COMMENT '期初结余',
`qwjy` string COMMENT '期未结余',
`dycs` string COMMENT '打印次数',
`bc` string COMMENT '被冲',
`bch` string COMMENT '被冲号',
`czr` string COMMENT '操作人',
`czsj` string COMMENT '操作时间',
`bz` string COMMENT '备注',
`sfmc` string COMMENT '收费名称',
`fph` string COMMENT '发票号',
`dz` string COMMENT '对账',
`xzdycs` string COMMENT '限制打印次数',
`fc` string COMMENT '费次',
`sffs` string COMMENT '实付方式',
`czyy` string COMMENT '冲账原因',
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '收费流水历史'
PARTITIONED BY (
`fq_sjzq` string)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/ods_data.db/ods_zlsgs_sflsls'
TBLPROPERTIES (
'bucketing_version'='2',
'transient_lastDdlTime'='1663641203') 
```

```sql
-- show create table dwd_data_lxcs.mxtj_dwd_cssjtjf

-- select * from dwd_data_lxcs.mxtj_dwd_cssjtjf

select * from ods_data_lxcs.test_sun2

-- truncate table ods_data_lxcs.test_sun2;

-- insert overwrite table ods_data_lxcs.test_sun2
-- select sflsh,sfsj,yhbh,sfn,sfy,fy,sfxz,fq_sjzq from ods_data.ods_zlsgs_sflsls
```

```sql	
CREATE TABLE `dwd_data_dx.dwd_gaj_bzdzpj`(
`id` string COMMENT 'ID',
`uuid` string COMMENT 'UUID',
`bm` string COMMENT '标准地址编码',
`bzdz` string COMMENT '标准地址名称',
`dzlx` string COMMENT '标准地址类型',
`puuid` string COMMENT '父级UUID',
`tcid` string COMMENT '图层编码',
`tyid` string COMMENT '图元编码',
`zbx` string COMMENT '图元X',
`zby` string COMMENT '图元Y',
`ysid` string COMMENT '标准地址元素ID',
`zt` string COMMENT '生命周期状态',
`ssjg` string COMMENT '所属机构',
`sszrq` string COMMENT '所属责任区',
`zcsj` string COMMENT '注册时间',
`qysj` string COMMENT '启用时间',
`bgsj` string COMMENT '变更时间',
`tysj` string COMMENT '停用时间',
`zxsj` string COMMENT '注销时间',
`cjyh` string COMMENT '最后一次维护用户',
`bz` string COMMENT '备注',
`xzqid` string COMMENT '最后一级行政区',
`xzqdm` string COMMENT '行政区地名',
`dqid` string COMMENT '大区',
`dqdm` string COMMENT '大区地名',
`jlxid` string COMMENT '街路巷',
`jlxqc` string COMMENT '街路巷全称',
`zrcid` string COMMENT '自然村',
`zrcqc` string COMMENT '自然村全称',
`mphid` string COMMENT '门牌号',
`mphqc` string COMMENT '门牌号全名称',
`xqid` string COMMENT '小区',
`xqqc` string COMMENT '小区全称',
`jzwid` string COMMENT '建筑物',
`jzwqc` string COMMENT '建筑物全称',
`dyid` string COMMENT '单元',
`dyjc` string COMMENT '单元简称',
`lcid` string COMMENT '楼层',
`lcjc` string COMMENT '楼层简称',
`fjid` string COMMENT '房间',
`fjjc` string COMMENT '房间简称',
`whjg` string COMMENT '最后一次维护机构',
`whsj` string COMMENT '最后一次维护时间',
`whyh` string COMMENT '最后一次维护用户2',
`zcjg` string COMMENT '注册机构',
`zcyh` string COMMENT '注册用户',
`sjlysd` string COMMENT '数据来源属地',
`jlrksj` string COMMENT '记录入库时间',
`zhgxsj` string COMMENT '最后更新时间',
`jlscbz` string COMMENT '记录删除标记',
`cwdm` string COMMENT '错误代码',
`sfrysc` string COMMENT '是否入要素层',
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '标准地址(派基)'
PARTITIONED BY (
`fq_sjzq` string COMMENT '分区字段')
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/dwd_data_dx.db/dwd_gaj_bzdzpj' 
```

```sql
alter table dwd_data_lxcs.csaq_dwd_jtaqmx drop if exists partition (fqzd =${DT});
alter table dwd_data_lxcs.csaq_dwd_jtaqmx drop if exists partition (fqzd =${dt});
insert overwrite table  dwd_data_lxcs.csaq_dwd_jtaqmx partition(fqzd=${dt})
select
wfbh,ryfl,jszh,dabh,fzjg,zjcx,dsr,zsxzqh,zsxxdz,dh,lxfs,clfl,hpzl,hphm,jdcsyr,syxz,jtfs,wfsj,xzqh,dllx,glxzdj,wfdz,
wfxw,wfjfs,fkje,zqmj,fxjg,fxjgmc,cljg,cljgmc,cfzl,clsj,qzcspzbh,jsjqbj,sgdj,cldxbj,jdccldxbj,zjmc,cclzrq,nl,xb,jd,
wd,jsrxz,clyt,sftgxcfw,dzzb
from std_data_lxcs.csaq_std_wfjlxx
where fqzd in(select max(fqzd) from std_data_lxcs.csaq_std_wfjlxx)

```

去重：
```sql
select * from (
    select *,
    row_number() over( partition by id,uuid,bm,bzdz,dzlx,puuid,tcid,tyid,zbx,
    zby,ysid,zt,ssjg,sszrq,zcsj,qysj,bgsj,tysj,zxsj,cjyh,bz,xzqid,xzqdm,dqid,
    dqdm,jlxid,jlxqc,zrcid,zrcqc,mphid,mphqc,xqid,xqqc,jzwid,jzwqc,dyid,dyjc,
    lcid,lcjc,fjid,fjjc,whjg,whsj,whyh,zcjg,zcyh,sjlysd,jlrksj,zhgxsj,jlscbz,
    cwdm,sfrysc,xxrksj,sywyid) rn from ods_data.ods_gaj_bzdzpj
) t where rn = 1
and fq_sjzq in (select max(fq_sjzq) from ods_data.ods_gaj_bzdzpj)
```

规整
```sql
truncate table dwd_data_dx.dwd_gaj_bzdzpj
insert overwrite table dwd_data_dx.dwd_gaj_bzdzpj partition (fq_sjzq=${yyyymmdd})
select id,uuid,bm,bzdz,dzlx,puuid,tcid,tyid,zbx,
    zby,ysid,zt,ssjg,sszrq,zcsj,qysj,bgsj,tysj,zxsj,cjyh,bz,xzqid,xzqdm,dqid,
    dqdm,jlxid,jlxqc,zrcid,zrcqc,mphid,mphqc,xqid,xqqc,jzwid,jzwqc,dyid,dyjc,
    lcid,lcjc,fjid,fjjc,whjg,whsj,whyh,zcjg,zcyh,sjlysd,jlrksj,zhgxsj,jlscbz,
    cwdm,sfrysc,xxrksj,sywyid,fq_sjzq
from ods_data.ods_gaj_bzdzpj 
where fq_sjzq in (select max(fq_sjzq) from ods_data.ods_gaj_bzdzpj)
group by 
    id,uuid,bm,bzdz,dzlx,puuid,tcid,tyid,zbx,
    zby,ysid,zt,ssjg,sszrq,zcsj,qysj,bgsj,tysj,zxsj,cjyh,bz,xzqid,xzqdm,dqid,
    dqdm,jlxid,jlxqc,zrcid,zrcqc,mphid,mphqc,xqid,xqqc,jzwid,jzwqc,dyid,dyjc,
    lcid,lcjc,fjid,fjjc,whjg,whsj,whyh,zcjg,zcyh,sjlysd,jlrksj,zhgxsj,jlscbz,
    cwdm,sfrysc,xxrksj,sywyid,fq_sjzq
```

# `ods_data.ods_gaj_czrkjbxx` ——常住(户籍)人口信息


```sql
CREATE TABLE `dwd_data_dx.dwd_gaj_czrkjbxx`(
`rynbid` string COMMENT '人员内部ID',
`ryid` string COMMENT '人员ID',
`hhnbid` string COMMENT '户号内部ID',
`mlpnbid` string COMMENT '门楼牌内部ID',
`zpid` string COMMENT '照片ID',
`nbsfzid` string COMMENT '内部身份证ID',
`gmsfhm` string COMMENT '公民身份证号',
`qfjg` string COMMENT '签发机关',
`yxqxqsrq` string COMMENT '有效期限起始日期',
`yxqxjzrq` string COMMENT '有效期限结束日期',
`xm` string COMMENT '姓名',
`cym` string COMMENT '曾用名',
`xmpy` string COMMENT '姓名拼音',
`cympy` string COMMENT '曾用名拼音',
`xb` string COMMENT '性别',
`mz` string COMMENT '民族',
`csrq` string COMMENT '出生日期',
`cssj` string COMMENT '出生时间',
`csdgjdq` string COMMENT '出生地国家地区',
`csdssxq` string COMMENT '出生地省市县区',
`csdxz` string COMMENT '出生地详址',
`dhhm` string COMMENT '电话号码',
`jhryxm` string COMMENT '监护人一姓名',
`jhrygmsfhm` string COMMENT '监护人一身份证号',
`jhryjhgx` string COMMENT '监护人一关系',
`jhrexm` string COMMENT '监护人二姓名',
`jhregmsfhm` string COMMENT '监护人二身份证号',
`jhrejhgx` string COMMENT '监护人二关系',
`fqxm` string COMMENT '父亲姓名',
`fqgmsfhm` string COMMENT '父亲身份证号',
`mqxm` string COMMENT '母亲姓名',
`mqgmsfhm` string COMMENT '母亲身份证号',
`poxm` string COMMENT '配偶姓名',
`pogmsfhm` string COMMENT '配偶身份证号',
`jggjdq` string COMMENT '籍贯国家地区',
`jgssxq` string COMMENT '籍贯省市县区',
`zjxy` string COMMENT '宗教信仰',
`whcd` string COMMENT '文化程度',
`hyzk` string COMMENT '婚姻状况',
`byzk` string COMMENT '兵役状况',
`sg` string COMMENT '身高',
`xx` string COMMENT '血型',
`zy` string COMMENT '职业',
`zylb` string COMMENT '职业类别',
`fwcs` string COMMENT '服务处所',
`xxjb` string COMMENT '信息级别',
`hsql` string COMMENT '何时迁来',
`hyql` string COMMENT '何因迁来',
`hgjdqql` string COMMENT '何国家地区迁来',
`hssxqql` string COMMENT '何省市县区迁来',
`hxzql` string COMMENT '何详址迁来',
`hslbz` string COMMENT '何时来本址',
`hylbz` string COMMENT '何因来本址',
`hgjdqlbz` string COMMENT '何国家地区来本址',
`hsssqlbz` string COMMENT '何省市县区来本址',
`hxzlbz` string COMMENT '何详址来本址',
`swrq` string COMMENT '死亡时间',
`swzxlb` string COMMENT '死亡注销类别',
`swzxrq` string COMMENT '死亡注销日期',
`qcrq` string COMMENT '迁出日期',
`qczxlb` string COMMENT '迁出注销类别',
`qwdgjdq` string COMMENT '迁往地国家地区',
`qwdssxq` string COMMENT '迁往地省市县区',
`qwdxz` string COMMENT '迁往地详址',
`cszmbh` string COMMENT '出生证明编号',
`cszqfrq` string COMMENT '出生证签发日期',
`hylb` string COMMENT '行业类别',
`qtssxq` string COMMENT '其它省市县区',
`qtzz` string COMMENT '其它住址',
`rylb` string COMMENT '人员类别',
`hb` string COMMENT '户别',
`yhzgx` string COMMENT '与户主关系',
`ryzt` string COMMENT '人员状态',
`rysdzt` string COMMENT '人员锁定状态',
`lxdbid` string COMMENT '离线DBID',
`bz` string COMMENT '备注',
`jlbz` string COMMENT '记录标志',
`ywnr` string COMMENT '业务内容',
`cjhjywid` string COMMENT '创建户籍业务ID',
`cchjywid` string COMMENT '撤除户籍业务ID',
`qysj` string COMMENT '启用时间',
`jssj` string COMMENT '结束时间',
`cxbz` string COMMENT '撤销标志',
`zjlb` string COMMENT '证件类别',
`jlx` string COMMENT '街路巷',
`mlph` string COMMENT '门楼牌号',
`mlxz` string COMMENT '门楼详址',
`pcs` string COMMENT '派出所代码',
`zrq` string COMMENT '责任区',
`xzjd` string COMMENT '乡镇街道办',
`jcwh` string COMMENT '居委会',
`pxh` string COMMENT '排序号',
`mlpid` string COMMENT '门楼牌ID',
`ssxq` string COMMENT '行政区划',
`hh` string COMMENT '户号',
`hlx` string COMMENT '户类型',
`hhid` string COMMENT '户号ID',
`bdfw` string COMMENT '变动方式',
`xxqysj` string COMMENT '信息启用时间',
`dhhm2` string COMMENT '电话号码2',
`gxsj` string COMMENT '更新时间戳，格式yyyyMMddHH24mmss',
`zxsj` string COMMENT '死亡，注销的注销时间（合并SWRQ、QCRQ）',
`crynbid` string COMMENT '人员内部ID2',
`gxsjd` string COMMENT '更新时间戳',
`xmx` string COMMENT '姓',
`xmm` string COMMENT '名',
`jgxz` string COMMENT '籍贯详细地址',
`jhryzjzl` string COMMENT '监护人一证件种类',
`jhryzjhm` string COMMENT '监护人一证件号码',
`jhrywwx` string COMMENT '监护人一外文姓',
`jhrywwm` string COMMENT '监护人一外文名',
`jhrylxdh` string COMMENT '监护人一联系电话',
`jhrezjzl` string COMMENT '监护人二证件种类',
`jhrezjhm` string COMMENT '监护人二证件号码',
`jhrewwx` string COMMENT '监护人二外文姓',
`jhrewwm` string COMMENT '监护人二外文名',
`jhrelxdh` string COMMENT '监护人二联系电话',
`fqzjzl` string COMMENT '父亲证件种类',
`fqzjhm` string COMMENT '父亲证件号码',
`fqwwx` string COMMENT '父亲外文姓',
`fqwwm` string COMMENT '父亲外文名',
`mqzjzl` string COMMENT '母亲证件种类',
`mqzjhm` string COMMENT '母亲证件号码',
`mqwwx` string COMMENT '母亲外文姓',
`mqwwm` string COMMENT '母亲外文名',
`pozjzl` string COMMENT '配偶证件种类',
`pozjhm` string COMMENT '配偶证件号码',
`powwx` string COMMENT '配偶外文姓',
`powwm` string COMMENT '配偶外文名',
`hjdzbm` string COMMENT '户籍地址编码',
`hjdrhyz` string COMMENT '户籍地人户一致标识',
`cydwbm` string COMMENT '从业单位编码',
`qyldyy` string COMMENT '迁移（流动）原因',
`fqzd` string COMMENT '分区字段',
`sjlysd` string COMMENT '数据来源属地',
`jlrksj` string COMMENT '记录入库时间',
`zhgxsj` string COMMENT '最后更新时间',
`jlscbz` string COMMENT '记录删除标记',
`cwdm` string COMMENT '错误代码',
`sfrysc` string COMMENT '是否入要素层',
`jlxmc` string COMMENT '街路巷名称',
`id` string COMMENT '主键ID',
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '常住(户籍)人口信息'
PARTITIONED BY (
`fq_sjzq` string COMMENT '分区字段')
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/dwd_data_dx.db/dwd_gaj_czrkjbxx'
```

dwd_data_dx.dwd_gaj_czrkjbxx
```sql
truncate table dwd_data_dx.dwd_gaj_czrkjbxx;

insert overwrite table dwd_data_dx.dwd_gaj_czrkjbxx partition (fq_sjzq='20221201')
select rynbid,ryid,hhnbid,mlpnbid,zpid,nbsfzid,gmsfhm,qfjg,yxqxqsrq,
yxqxjzrq,xm,cym,xmpy,cympy,xb,mz,csrq,cssj,csdgjdq,csdssxq,
csdxz,dhhm,jhryxm,jhrygmsfhm,jhryjhgx,jhrexm,jhregmsfhm,jhrejhgx,
fqxm,fqgmsfhm,mqxm,mqgmsfhm,poxm,pogmsfhm,jggjdq,jgssxq,zjxy,whcd,
hyzk,byzk,sg,xx,zy,zylb,fwcs,xxjb,hsql,hyql,hgjdqql,hssxqql,hxzql,
hslbz,hylbz,hgjdqlbz,hsssqlbz,hxzlbz,swrq,swzxlb,swzxrq,qcrq,qczxlb,
qwdgjdq,qwdssxq,qwdxz,cszmbh,cszqfrq,hylb,qtssxq,qtzz,rylb,hb,yhzgx,
ryzt,rysdzt,lxdbid,bz,jlbz,ywnr,cjhjywid,cchjywid,qysj,jssj,cxbz,zjlb,
jlx,mlph,mlxz,pcs,zrq,xzjd,jcwh,pxh,mlpid,ssxq,hh,hlx,hhid,bdfw,xxqysj,
dhhm2,gxsj,zxsj,crynbid,gxsjd,xmx,xmm,jgxz,jhryzjzl,jhryzjhm,jhrywwx,
jhrywwm,jhrylxdh,jhrezjzl,jhrezjhm,jhrewwx,jhrewwm,jhrelxdh,fqzjzl,
fqzjhm,fqwwx,fqwwm,mqzjzl,mqzjhm,mqwwx,mqwwm,pozjzl,pozjhm,powwx,powwm,
hjdzbm,hjdrhyz,cydwbm,qyldyy,fqzd,sjlysd,jlrksj,zhgxsj,jlscbz,cwdm,
sfrysc,jlxmc,id,xxrksj,sywyid
from ods_data.ods_gaj_czrkjbxx
where fq_sjzq in (select max(fq_sjzq) from ods_data.ods_gaj_czrkjbxx)
group by rynbid,ryid,hhnbid,mlpnbid,zpid,nbsfzid,gmsfhm,qfjg,yxqxqsrq,
yxqxjzrq,xm,cym,xmpy,cympy,xb,mz,csrq,cssj,csdgjdq,csdssxq,
csdxz,dhhm,jhryxm,jhrygmsfhm,jhryjhgx,jhrexm,jhregmsfhm,jhrejhgx,
fqxm,fqgmsfhm,mqxm,mqgmsfhm,poxm,pogmsfhm,jggjdq,jgssxq,zjxy,whcd,
hyzk,byzk,sg,xx,zy,zylb,fwcs,xxjb,hsql,hyql,hgjdqql,hssxqql,hxzql,
hslbz,hylbz,hgjdqlbz,hsssqlbz,hxzlbz,swrq,swzxlb,swzxrq,qcrq,qczxlb,
qwdgjdq,qwdssxq,qwdxz,cszmbh,cszqfrq,hylb,qtssxq,qtzz,rylb,hb,yhzgx,
ryzt,rysdzt,lxdbid,bz,jlbz,ywnr,cjhjywid,cchjywid,qysj,jssj,cxbz,zjlb,
jlx,mlph,mlxz,pcs,zrq,xzjd,jcwh,pxh,mlpid,ssxq,hh,hlx,hhid,bdfw,xxqysj,
dhhm2,gxsj,zxsj,crynbid,gxsjd,xmx,xmm,jgxz,jhryzjzl,jhryzjhm,jhrywwx,
jhrywwm,jhrylxdh,jhrezjzl,jhrezjhm,jhrewwx,jhrewwm,jhrelxdh,fqzjzl,
fqzjhm,fqwwx,fqwwm,mqzjzl,mqzjhm,mqwwx,mqwwm,pozjzl,pozjhm,powwx,powwm,
hjdzbm,hjdrhyz,cydwbm,qyldyy,fqzd,sjlysd,jlrksj,zhgxsj,jlscbz,cwdm,
sfrysc,jlxmc,id,xxrksj,sywyid
```

ods_data.ods_gaj_rkjzxxbpj
```sql
CREATE EXTERNAL TABLE `ods_data.ods_gaj_rkjzxxbpj`(
`id` string COMMENT 'ID',
`fwid` string COMMENT '与房屋基本信息表外键关联',
`rid` string COMMENT '与人口基本信息表外键关联',
`jzlx` string COMMENT '居住类型BH，0户籍人口、1流动人口、2未落常住、3境外人员',
`jzzl` string COMMENT '居住子类BH：01人户一致，02人户均在本所但不一致，03户在本所但人不在，04人在本所但户不在，11跨县区居住，12跨市居住，13跨省居住',
`sfsz` string COMMENT '是否户主，1是、0否',
`szrid` string COMMENT '户主人ID，与人口基本信息表外键关联',
`yszgx` string COMMENT '与室主关系BH与户主关系，与字典表外键关联',
`zyfwkjjtwz` string COMMENT '占用房屋空间具体位置，默认值为“整个房屋”',
`sfczr` string COMMENT '是否承租人，1是、0否',
`djyy` string COMMENT '登记原因BH，与字典表外键关联',
`jzrq` string COMMENT '居住日期',
`sflz` string COMMENT '是否楼长，1是、0否',
`sfxxy` string COMMENT '是否信息员，1是、0否',
`sfdj` string COMMENT '是否独居，1是、0否',
`qtzz` string COMMENT '其他住址',
`sqid` string COMMENT '所属社区，与警务社区表外键关联',
`bz` string COMMENT '备注',
`zhfcrq` string COMMENT '最后访查日期',
`yxzt` string COMMENT '有效状态，1有效、0无效，已注销',
`djjg` string COMMENT '登记机构，与登记机构表外键关联',
`djr` string COMMENT '登记人，与民警用户表外键关联',
`djsj` string COMMENT '登记时间',
`zhxgjg` string COMMENT '最后修改机构，与组织机构表外键关联',
`zhxgr` string COMMENT '最后修改人，与民警用户表外键关联',
`zhxgsj` string COMMENT '最后修改时间，默认为当前时间',
`djrdm` string COMMENT '登记人代码',
`djrxm` string COMMENT '登记人姓名',
`djjgdm` string COMMENT '登记机构代码',
`djjgmc` string COMMENT '登记机构名称',
`zhxgrdm` string COMMENT '最后修改人代码',
`zhxgrxm` string COMMENT '最后修改人姓名',
`zhxgjgdm` string COMMENT '最后修改机构代码',
`zhxgjgmc` string COMMENT '最后修改机构名称',
`sjlysd` string COMMENT '数据来源属地',
`jlrksj` string COMMENT '记录入库时间',
`zhgxsj` string COMMENT '最后更新时间',
`jlscbz` string COMMENT '记录删除标记',
`cwdm` string COMMENT '错误代码',
`sfrysc` string COMMENT '是否入要素层',
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '人口居住信息表(派基)'
PARTITIONED BY (
`fq_sjzq` string COMMENT '分区字段')
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/ods_data.db/ods_gaj_rkjzxxbpj'
TBLPROPERTIES (
'bucketing_version'='2',
'transient_lastDdlTime'='1640227808') 
```

CREATE TABLE `dwd_data_dx.dwd_gaj_rkjzxxbpj`
```sql
CREATE TABLE `dwd_data_dx.dwd_gaj_rkjzxxbpj`(
`id` string COMMENT 'ID',
`fwid` string COMMENT '与房屋基本信息表外键关联',
`rid` string COMMENT '与人口基本信息表外键关联',
`jzlx` string COMMENT '居住类型BH，0户籍人口、1流动人口、2未落常住、3境外人员',
`jzzl` string COMMENT '居住子类BH：01人户一致，02人户均在本所但不一致，03户在本所但人不在，04人在本所但户不在，11跨县区居住，12跨市居住，13跨省居住',
`sfsz` string COMMENT '是否户主，1是、0否',
`szrid` string COMMENT '户主人ID，与人口基本信息表外键关联',
`yszgx` string COMMENT '与室主关系BH与户主关系，与字典表外键关联',
`zyfwkjjtwz` string COMMENT '占用房屋空间具体位置，默认值为“整个房屋”',
`sfczr` string COMMENT '是否承租人，1是、0否',
`djyy` string COMMENT '登记原因BH，与字典表外键关联',
`jzrq` string COMMENT '居住日期',
`sflz` string COMMENT '是否楼长，1是、0否',
`sfxxy` string COMMENT '是否信息员，1是、0否',
`sfdj` string COMMENT '是否独居，1是、0否',
`qtzz` string COMMENT '其他住址',
`sqid` string COMMENT '所属社区，与警务社区表外键关联',
`bz` string COMMENT '备注',
`zhfcrq` string COMMENT '最后访查日期',
`yxzt` string COMMENT '有效状态，1有效、0无效，已注销',
`djjg` string COMMENT '登记机构，与登记机构表外键关联',
`djr` string COMMENT '登记人，与民警用户表外键关联',
`djsj` string COMMENT '登记时间',
`zhxgjg` string COMMENT '最后修改机构，与组织机构表外键关联',
`zhxgr` string COMMENT '最后修改人，与民警用户表外键关联',
`zhxgsj` string COMMENT '最后修改时间，默认为当前时间',
`djrdm` string COMMENT '登记人代码',
`djrxm` string COMMENT '登记人姓名',
`djjgdm` string COMMENT '登记机构代码',
`djjgmc` string COMMENT '登记机构名称',
`zhxgrdm` string COMMENT '最后修改人代码',
`zhxgrxm` string COMMENT '最后修改人姓名',
`zhxgjgdm` string COMMENT '最后修改机构代码',
`zhxgjgmc` string COMMENT '最后修改机构名称',
`sjlysd` string COMMENT '数据来源属地',
`jlrksj` string COMMENT '记录入库时间',
`zhgxsj` string COMMENT '最后更新时间',
`jlscbz` string COMMENT '记录删除标记',
`cwdm` string COMMENT '错误代码',
`sfrysc` string COMMENT '是否入要素层',
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '人口居住信息表(派基)'
PARTITIONED BY (
`fq_sjzq` string COMMENT '分区字段')
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/dwd_data_dx.db/dwd_gaj_rkjzxxbpj'
```

规整
```sql
alter table dwd_data_dx.dwd_gaj_rkjzxxbpj drop if exists partition(fq_sjzq<);

insert overwrite table dwd_data_dx.dwd_gaj_rkjzxxbpj partition (fq_sjzq='')
select id, fwid, rid, jzlx, jzzl, sfsz, szrid, yszgx, zyfwkjjtwz, sfczr, djyy, jzrq, sflz, sfxxy, sfdj, qtzz, sqid, bz, zhfcrq, yxzt, djjg, djr, djsj, zhxgjg, zhxgr, zhxgsj, djrdm, djrxm, djjgdm, djjgmc, zhxgrdm, zhxgrxm, zhxgjgdm, zhxgjgmc, sjlysd, jlrksj, zhgxsj, jlscbz, cwdm, sfrysc, xxrksj, sywyid
from ods_data.ods_gaj_rkjzxxbpj
where fq_sjzq in (select max(fq_sjzq) from ods_data.ods_gaj_rkjzxxbpj)
group by id, fwid, rid, jzlx, jzzl, sfsz, szrid, yszgx, zyfwkjjtwz, sfczr, djyy, jzrq, sflz, sfxxy, sfdj, qtzz, sqid, bz, zhfcrq, yxzt, djjg, djr, djsj, zhxgjg, zhxgr, zhxgsj, djrdm, djrxm, djjgdm, djjgmc, zhxgrdm, zhxgrxm, zhxgjgdm, zhxgjgmc, sjlysd, jlrksj, zhgxsj, jlscbz, cwdm, sfrysc, xxrksj, sywyid
``` 


#### 模型_居住证信息(派基)_公安局

旧表
CREATE EXTERNAL TABLE `ods_data.ods_gaj_jzzxxpj`
```sql
CREATE EXTERNAL TABLE `ods_data.ods_gaj_jzzxxpj`(
`id` string COMMENT 'ID',
`jzzbh` string COMMENT '居住证编号',
`rid` string COMMENT '人ID',
`rkjzid` string COMMENT '户人ID，与户人关联表外键关联',
`gmsfhm` string COMMENT '公民身份号码',
`fwid` string COMMENT '房屋ID',
`xm` string COMMENT '姓名',
`xb` string COMMENT '性别',
`csrq` string COMMENT '出生日期',
`mz` string COMMENT '名族',
`hjdz` string COMMENT '户籍地址',
`jzdz` string COMMENT '居住地址',
`yxqxs` string COMMENT '有效期限开始时间',
`yxqxe` string COMMENT '有效期限j截止时间',
`qfjg` string COMMENT '签发机关',
`slyy` string COMMENT '申领原因',
`ryzpid` string COMMENT '关联 T_RK_ZPXX 表',
`zjlx` string COMMENT '1=长期证，2=短期证',
`sqr` string COMMENT '申请人',
`sqjg` string COMMENT '申请人所在机构',
`sqsj` string COMMENT '申请时间',
`shr` string COMMENT '审核人',
`shjg` string COMMENT '审核人所在机构',
`shyj` string COMMENT '审核意见',
`shsj` string COMMENT '审核时间',
`spr` string COMMENT '审批人',
`spjg` string COMMENT '审批人所在机构',
`spyj` string COMMENT '审批意见',
`spsj` string COMMENT '审批时间',
`zzr` string COMMENT '制证人',
`zzjg` string COMMENT '制证人所在机构',
`zzsj` string COMMENT '制证时间',
`fzr` string COMMENT '发证人',
`fzjg` string COMMENT '发证人所在机构',
`fzsj` string COMMENT '发证时间',
`sfdyhzd` string COMMENT '0=未打印，1=已打印',
`hzdxh` string COMMENT '回执单序号',
`zjzt` string COMMENT '1=已受理，3=已提交待审核，5=已审核待审批，7=已审批待制证，9=退回，11=已制证，13=挂失，15=到期换领，17=已发证，98=缴销，99=逻辑删除',
`dyzt` string COMMENT '1=未打印，2=已打印身份证信息，3=已打印居住证信息',
`clbz` string COMMENT '1=正常，2=挂失处理过程，3=延期处理过程',
`sfydzjdz` string COMMENT '0=没有，1=有，2=已追加',
`zjr` string COMMENT '追加人',
`zjjg` string COMMENT '追加机构',
`zjdzmc` string COMMENT '追加地址名称',
`djjg` string COMMENT '登记机构，与登记机构表外键关联',
`djr` string COMMENT '登记人，与民警用户表外键关联',
`djsj` string COMMENT '登记时间',
`zhxgjg` string COMMENT '最后修改机构，与组织机构表外键关联',
`zhxgr` string COMMENT '最后修改人，与民警用户表外键关联',
`zhxgsj` string COMMENT '最后修改时间，默认为当前时间',
`dzzjid` string COMMENT '地址追加ID',
`djrdm` string COMMENT '登记人代码',
`djrxm` string COMMENT '登记人姓名',
`djjgdm` string COMMENT '登记机构代码',
`djjgmc` string COMMENT '登记机构名称',
`zhxgrdm` string COMMENT '最后修改人代码',
`zhxgrxm` string COMMENT '最后修改人姓名',
`zhxgjgdm` string COMMENT '最后修改机构代码',
`zhxgjgmc` string COMMENT '最后修改机构名称',
`ywid` string COMMENT '业务ID，外网办理居住证业务数据ID',
`ywlx` string COMMENT '01 一站通 99 其他 用于外网办理居住证业务类型，默认为空，为派基办理居住证业务 ',
`sjlysd` string,
`jlrksj` string,
`zhgxsj` string,
`jlscbz` string,
`cwdm` string,
`sfrysc` string,
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '居住证信息(派基)'
PARTITIONED BY (
`fq_sjzq` string)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/ods_data.db/ods_gaj_jzzxxpj'
TBLPROPERTIES (
'bucketing_version'='2',
'transient_lastDdlTime'='1640227813') 
```

新表
CREATE TABLE `dwd_data_dx.dwd_gaj_jzzxxpj` ——居住证信息(派基)
```sql
CREATE TABLE `dwd_data_dx.dwd_gaj_jzzxxpj`(
`id` string COMMENT 'ID',
`jzzbh` string COMMENT '居住证编号',
`rid` string COMMENT '人ID',
`rkjzid` string COMMENT '户人ID，与户人关联表外键关联',
`gmsfhm` string COMMENT '公民身份号码',
`fwid` string COMMENT '房屋ID',
`xm` string COMMENT '姓名',
`xb` string COMMENT '性别',
`csrq` string COMMENT '出生日期',
`mz` string COMMENT '名族',
`hjdz` string COMMENT '户籍地址',
`jzdz` string COMMENT '居住地址',
`yxqxs` string COMMENT '有效期限开始时间',
`yxqxe` string COMMENT '有效期限截止时间',
`qfjg` string COMMENT '签发机关',
`slyy` string COMMENT '申领原因',
`ryzpid` string COMMENT '关联 T_RK_ZPXX 表',
`zjlx` string COMMENT '1=长期证，2=短期证',
`sqr` string COMMENT '申请人',
`sqjg` string COMMENT '申请人所在机构',
`sqsj` string COMMENT '申请时间',
`shr` string COMMENT '审核人',
`shjg` string COMMENT '审核人所在机构',
`shyj` string COMMENT '审核意见',
`shsj` string COMMENT '审核时间',
`spr` string COMMENT '审批人',
`spjg` string COMMENT '审批人所在机构',
`spyj` string COMMENT '审批意见',
`spsj` string COMMENT '审批时间',
`zzr` string COMMENT '制证人',
`zzjg` string COMMENT '制证人所在机构',
`zzsj` string COMMENT '制证时间',
`fzr` string COMMENT '发证人',
`fzjg` string COMMENT '发证人所在机构',
`fzsj` string COMMENT '发证时间',
`sfdyhzd` string COMMENT '0=未打印，1=已打印',
`hzdxh` string COMMENT '回执单序号',
`zjzt` string COMMENT '1=已受理，3=已提交待审核，5=已审核待审批，7=已审批待制证，9=退回，11=已制证，13=挂失，15=到期换领，17=已发证，98=缴销，99=逻辑删除',
`dyzt` string COMMENT '1=未打印，2=已打印身份证信息，3=已打印居住证信息',
`clbz` string COMMENT '1=正常，2=挂失处理过程，3=延期处理过程',
`sfydzjdz` string COMMENT '0=没有，1=有，2=已追加',
`zjr` string COMMENT '追加人',
`zjjg` string COMMENT '追加机构',
`zjdzmc` string COMMENT '追加地址名称',
`djjg` string COMMENT '登记机构，与登记机构表外键关联',
`djr` string COMMENT '登记人，与民警用户表外键关联',
`djsj` string COMMENT '登记时间',
`zhxgjg` string COMMENT '最后修改机构，与组织机构表外键关联',
`zhxgr` string COMMENT '最后修改人，与民警用户表外键关联',
`zhxgsj` string COMMENT '最后修改时间，默认为当前时间',
`dzzjid` string COMMENT '地址追加ID',
`djrdm` string COMMENT '登记人代码',
`djrxm` string COMMENT '登记人姓名',
`djjgdm` string COMMENT '登记机构代码',
`djjgmc` string COMMENT '登记机构名称',
`zhxgrdm` string COMMENT '最后修改人代码',
`zhxgrxm` string COMMENT '最后修改人姓名',
`zhxgjgdm` string COMMENT '最后修改机构代码',
`zhxgjgmc` string COMMENT '最后修改机构名称',
`ywid` string COMMENT '业务ID，外网办理居住证业务数据ID',
`ywlx` string COMMENT '01 一站通 99 其他 用于外网办理居住证业务类型，默认为空，为派基办理居住证业务 ',
`sjlysd` string,
`jlrksj` string,
`zhgxsj` string,
`jlscbz` string,
`cwdm` string,
`sfrysc` string,
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '居住证信息(派基)'
PARTITIONED BY (
`fq_sjzq` string COMMENT '分区字段')
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/dwd_data_dx.db/dwd_gaj_jzzxxpj'
```

规整
```sql
alter table dwd_data_dx.dwd_gaj_jzzxxpj drop if exists partition(fq_sjzq = '20221202');

insert overwrite table dwd_data_dx.dwd_gaj_jzzxxpj partition (fq_sjzq='20221202')
select id,jzzbh,rid,rkjzid,gmsfhm,fwid,xm,xb,csrq,mz,hjdz,jzdz,yxqxs,yxqxe,qfjg,slyy,ryzpid,zjlx,sqr,sqjg,sqsj,shr,shjg,shyj,shsj,spr,spjg,spyj,spsj,zzr,zzjg,zzsj,fzr,fzjg,fzsj,sfdyhzd,hzdxh,zjzt,dyzt,clbz,sfydzjdz,zjr,zjjg,zjdzmc,djjg,djr,djsj,zhxgjg,zhxgr,zhxgsj,dzzjid,djrdm,djrxm,djjgdm,djjgmc,zhxgrdm,zhxgrxm,zhxgjgdm,zhxgjgmc,ywid,ywlx,sjlysd,jlrksj,zhgxsj,jlscbz,cwdm,sfrysc,xxrksj,sywyid
from ods_data.ods_gaj_jzzxxpj
where fq_sjzq in (select max(fq_sjzq) from ods_data.ods_gaj_jzzxxpj)
group by id,jzzbh,rid,rkjzid,gmsfhm,fwid,xm,xb,csrq,mz,hjdz,jzdz,yxqxs,yxqxe,qfjg,slyy,ryzpid,zjlx,sqr,sqjg,sqsj,shr,shjg,shyj,shsj,spr,spjg,spyj,spsj,zzr,zzjg,zzsj,fzr,fzjg,fzsj,sfdyhzd,hzdxh,zjzt,dyzt,clbz,sfydzjdz,zjr,zjjg,zjdzmc,djjg,djr,djsj,zhxgjg,zhxgr,zhxgsj,dzzjid,djrdm,djrxm,djjgdm,djjgmc,zhxgrdm,zhxgrxm,zhxgjgdm,zhxgjgmc,ywid,ywlx,sjlysd,jlrksj,zhgxsj,jlscbz,cwdm,sfrysc,xxrksj,sywyid
```


#### 模型_企业刻章信息_公安局

`ods_data.ods_gaj_qykzxx`
```sql
CREATE EXTERNAL TABLE `ods_data.ods_gaj_qykzxx`(
`ywid` string COMMENT '业务ID',
`qymc` string COMMENT '企业名称',
`tyshxydm` string COMMENT '统一信用代码',
`xzqhbm` string COMMENT '行政区划编码',
`sqsj` string COMMENT '申请时间',
`slsj` string COMMENT '受理时间',
`bjsj` string COMMENT '办结时间',
`bbjtjclgs` string,
`xypt_time_dxp` string COMMENT '更新时间',
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '企业刻章信息'
PARTITIONED BY (
`fq_sjzq` string)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/ods_data.db/ods_gaj_qykzxx'
TBLPROPERTIES (
'bucketing_version'='2',
'transient_lastDdlTime'='1643167990') 
```

`dwd_data_dx.dwd_gaj_qykzxx`
```sql
CREATE TABLE `dwd_data_dx.dwd_gaj_qykzxx`(
`ywid` string COMMENT '业务ID',
`qymc` string COMMENT '企业名称',
`tyshxydm` string COMMENT '统一信用代码',
`xzqhbm` string COMMENT '行政区划编码',
`sqsj` string COMMENT '申请时间',
`slsj` string COMMENT '受理时间',
`bjsj` string COMMENT '办结时间',
`bbjtjclgs` string,
`xypt_time_dxp` string COMMENT '更新时间',
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '企业刻章信息'
PARTITIONED BY (
`fq_sjzq` string COMMENT '分区字段')
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/dwd_data_dx.db/dwd_gaj_qykzxx'
```

规整
```sql
alter table dwd_data_dx.dwd_gaj_qykzxx drop if exists partition(fq_sjzq = ${SYSDATE_YYYYMMDD});

insert overwrite table dwd_data_dx.dwd_gaj_qykzxx partition (fq_sjzq=${SYSDATE_YYYYMMDD})
select ywid,qymc,tyshxydm,xzqhbm,sqsj,slsj,bjsj,bbjtjclgs,xypt_time_dxp,xxrksj,sywyid
from ods_data.ods_gaj_qykzxx
where fq_sjzq in (select max(fq_sjzq) from ods_data.ods_gaj_qykzxx)
group by ywid,qymc,tyshxydm,xzqhbm,sqsj,slsj,bjsj,bbjtjclgs,xypt_time_dxp,xxrksj,sywyid
```

#### 模型_建筑物信息_公安局

`ods_data.ods_gaj_jzwxx`
```sql
CREATE EXTERNAL TABLE `ods_data.ods_gaj_jzwxx`(
`id` string COMMENT 'ID',
`bm` string COMMENT '编码',
`jc` string COMMENT '简称',
`qc` string COMMENT '全称',
`bc` string COMMENT '别称',
`szxzq` string COMMENT '所在行政区',
`szdq` string COMMENT '所在大区',
`szjlx` string COMMENT '所在主街路巷',
`szzrc` string COMMENT '所在自然村',
`sgmph` string COMMENT '所挂主门牌',
`szxq` string COMMENT '所在小区',
`sjjzw` string COMMENT '上级建筑物',
`tcid` string COMMENT '图层编码',
`tyid` string COMMENT '图元编码',
`zbx` string COMMENT '坐标X',
`zby` string COMMENT '坐标Y',
`zt` string COMMENT '生命周期状态',
`zrq` string COMMENT '责任区',
`sfxn` string COMMENT '是否虚拟',
`dscs` string COMMENT '地上层数',
`dxcs` string COMMENT '地下层数',
`gd` string COMMENT '建筑物高度',
`pyszm` string COMMENT '拼音首字母',
`zcsj` string COMMENT '注册时间',
`qysj` string COMMENT '启用时间',
`bgsj` string COMMENT '变更时间',
`tysj` string COMMENT '停用时间',
`zxsj` string COMMENT '注销时间',
`whyh` string COMMENT '最后一次维护人',
`bz` string COMMENT '备注',
`uuid` string COMMENT 'UUID',
`jzwlx` string COMMENT '建筑物类型 1平房 2楼房 3门面房',
`sfmj` string COMMENT '是否末级0非末级1末级',
`whsj` string COMMENT '最后一次维护时间',
`whjg` string COMMENT '维护机构',
`zcjg` string COMMENT '注册机构',
`zcyh` string COMMENT '注册用户',
`bzdzid` string COMMENT '标准地址ID',
`sjlysd` string,
`jlrksj` string,
`zhgxsj` string,
`jlscbz` string,
`cwdm` string,
`sfrysc` string,
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '建筑物信息'
PARTITIONED BY (
`fq_sjzq` string)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/ods_data.db/ods_gaj_jzwxx'
TBLPROPERTIES (
'bucketing_version'='2',
'transient_lastDdlTime'='1658126737') 
```

`dwd_data_dx.dwd_gaj_jzwxx`
```sql
CREATE TABLE `dwd_data_dx.dwd_gaj_jzwxx`(
`id` string COMMENT 'ID',
`bm` string COMMENT '编码',
`jc` string COMMENT '简称',
`qc` string COMMENT '全称',
`bc` string COMMENT '别称',
`szxzq` string COMMENT '所在行政区',
`szdq` string COMMENT '所在大区',
`szjlx` string COMMENT '所在主街路巷',
`szzrc` string COMMENT '所在自然村',
`sgmph` string COMMENT '所挂主门牌',
`szxq` string COMMENT '所在小区',
`sjjzw` string COMMENT '上级建筑物',
`tcid` string COMMENT '图层编码',
`tyid` string COMMENT '图元编码',
`zbx` string COMMENT '坐标X',
`zby` string COMMENT '坐标Y',
`zt` string COMMENT '生命周期状态',
`zrq` string COMMENT '责任区',
`sfxn` string COMMENT '是否虚拟',
`dscs` string COMMENT '地上层数',
`dxcs` string COMMENT '地下层数',
`gd` string COMMENT '建筑物高度',
`pyszm` string COMMENT '拼音首字母',
`zcsj` string COMMENT '注册时间',
`qysj` string COMMENT '启用时间',
`bgsj` string COMMENT '变更时间',
`tysj` string COMMENT '停用时间',
`zxsj` string COMMENT '注销时间',
`whyh` string COMMENT '最后一次维护人',
`bz` string COMMENT '备注',
`uuid` string COMMENT 'UUID',
`jzwlx` string COMMENT '建筑物类型 1平房 2楼房 3门面房',
`sfmj` string COMMENT '是否末级0非末级1末级',
`whsj` string COMMENT '最后一次维护时间',
`whjg` string COMMENT '维护机构',
`zcjg` string COMMENT '注册机构',
`zcyh` string COMMENT '注册用户',
`bzdzid` string COMMENT '标准地址ID',
`sjlysd` string,
`jlrksj` string,
`zhgxsj` string,
`jlscbz` string,
`cwdm` string,
`sfrysc` string,
`xxrksj` string COMMENT '信息入库时间',
`sywyid` string COMMENT '溯源唯一ID')
COMMENT '建筑物信息'
PARTITIONED BY (
`fq_sjzq` string COMMENT "分区字段")
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='$',
'serialization.format'='$')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'hdfs://hacluster/user/hive/warehouse/dwd_data_dx.db/dwd_gaj_jzwxx'
```

规整
```sql
alter table dwd_data_dx.dwd_gaj_jzwxx drop if exists partition(fq_sjzq = '20221202');

insert overwrite table dwd_data_dx.dwd_gaj_jzwxx partition (fq_sjzq = '20221202')
select id,bm,jc,qc,bc,szxzq,szdq,szjlx,szzrc,sgmph,szxq,sjjzw,tcid,tyid,zbx,zby,zt,zrq,sfxn,dscs,dxcs,gd,pyszm,zcsj,qysj,bgsj,tysj,zxsj,whyh,bz,uuid,jzwlx,sfmj,whsj,whjg,zcjg,zcyh,bzdzid,sjlysd,jlrksj,zhgxsj,jlscbz,cwdm,sfrysc,xxrksj,sywyid
from ods_data.ods_gaj_jzwxx
where fq_sjzq in (select max(fq_sjzq) from ods_data.ods_gaj_jzwxx)
group by id,bm,jc,qc,bc,szxzq,szdq,szjlx,szzrc,sgmph,szxq,sjjzw,tcid,tyid,zbx,zby,zt,zrq,sfxn,dscs,dxcs,gd,pyszm,zcsj,qysj,bgsj,tysj,zxsj,whyh,bz,uuid,jzwlx,sfmj,whsj,whjg,zcjg,zcyh,bzdzid,sjlysd,jlrksj,zhgxsj,jlscbz,cwdm,sfrysc,xxrksj,sywyid
```

























